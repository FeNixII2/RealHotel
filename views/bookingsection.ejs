<section id="booking" style="position: relative;">
    <div class="backgroundpage-image"></div>

    <div class="setcontainer pt-5 d-flex flex-column justify-content-between align-items-center vh-100">
        <div class="container pt-2">

            <div id="my-cards"></div>

            <div class="modal fade " id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title w-100 text-center" style="position: relative;">ยืนยันการจอง</h5>
                            <button type="button" class="btn-close " data-bs-dismiss="modal" aria-label="Close" style="position: absolute; right: 1.5rem;"></button>
                        </div>

                        <div class="modal-body p-1">
                            <div class="card p-3 ">
                                <div class="fs-5 d-flex mb-2">
                                    <i class="fa-solid fa-door-closed d-flex align-self-center"></i>
                                    <div class="ms-2">รายละเอียดห้องพัก</div>
                                </div>

                                <div class="rooms-label">
                                    ประเภท:
                                    <label id="roomtype-label"></label>
                                </div>
                                <div class="row ">
                                    <div class="col-6 col-sm-6 col-md-6 col-lg-6 ">
                                        เช็คอิน:
                                        <label id="checkin-label"></label>
                                    </div>
                                    <div class="col-6 col-sm-6 col-md-6 col-lg-6">
                                        เช็คเอ้าท์:
                                        <label id="checkout-label"></label>
                                    </div>
                                </div>

                            </div>

                            <div class="card p-3">
                                <div class="fs-5 mb-3 d-flex mb-4 mt-2">
                                    <i class="fa-solid fa-user d-flex align-self-center"></i>
                                    <div class="ms-2 ">ข้อมูลผู้เข้าพัก</div>
                                </div>

                                <form class="row g-3">
                                    <div class="col-md-6 my-custom-class">
                                        ชื่อ
                                        <input type="text" class="form-control" id="firstName" name="firstName" placeholder="กรอกชื่อ" required="required">
                                    </div>
                                    <div class="col-md-6 my-custom-class">
                                        นามสกุล
                                        <input type="text" class="form-control" id="lastName" name="lastName" placeholder="กรอกนามสกุล" required="required">
                                    </div>
                                    <div class="col-md-6 my-custom-class">
                                        เบอร์โทรศัพท์
                                        <input type="tel" class="form-control" id="p_number" name="p_number" placeholder="กรอกโทรศัพท์">
                                    </div>
                                    <div class="col-md-6 my-custom-class">
                                        อีเมลล์
                                        <input type="email" class="form-control" id="email" name="email" placeholder="กรอกอีเมลล์" required="required">
                                    </div>
                                </form>

                                <div class="mt-1 fs-5 d-flex mt-3 mb-2 mt-">
                                    <i class="fa-solid fa-note-sticky d-flex align-self-center"></i>
                                    <div class="ms-2  ">คำขอเพิ่มเติม</div>
                                </div>

                                <textarea class="form-control" name="more_info" id="more_info" rows="3" placeholder="กรอกข้อมูลเพิ่มเติม.."></textarea>

                            </div>

                            <div class="card p-3">



                                <!-- <div class="payment-s">

                            <% for(var i=0;i< payment_type.length;i++){ %>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" id="option<%=i%>" name="myGroup" value="<%=payment_type[i].id%>">
                                    <label class="form-check-label" for="option<%=i%>">
                                        <%=payment_type[i].pay_type%>
                                    </label>
                                </div>

                                <%}%>


                        </div> -->


                                <div class="textpaymeant fs-5 d-flex mb-2 mt-2">
                                    <i class="fa-solid fa-money-check-dollar d-flex align-self-center"></i>
                                    <div class="ms-2 ">รูปแบบการชำระเงิน</div>
                                </div>





                                <% var payment_type_left=payment_type.slice(0, Math.ceil(payment_type.length / 2)); var payment_type_right=payment_type.slice(Math.ceil(payment_type.length / 2)); %>

                                    <div class="payment-s row">
                                        <div class="col-6 col-sm-6 col-md-6 text-left">
                                            <% for(var i=0;i< payment_type_left.length;i++){ %>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" id="option<%=i%>" name="myGroup" value="<%=payment_type_left[i].id%>">
                                                    <label class="form-check-label" for="option<%=i%>">
                                                        <%=payment_type_left[i].pay_type%>
                                                    </label>
                                                </div>
                                                <%}%>
                                        </div>
                                        <div class="col-6 col-sm-6 col-md-6 text-right">
                                            <% for(var i=0;i< payment_type_right.length;i++){ %>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" id="option<%=i%+payment_type_left.length%>" name="myGroup" value="<%=payment_type_right[i].id%>">
                                                    <label class="form-check-label" for="option<%=i%+payment_type_left.length%>">
                                                        <%=payment_type_right[i].pay_type%>
                                                    </label>
                                                </div>
                                                <%}%>
                                        </div>
                                    </div>

                                    <div class="textprice fs-5 d-flex  mt-2">
                                        <i class="fa-solid fa-coins d-flex align-self-center"></i>
                                        <div class="ms-2 me-2">ราคารวมทั้งสิ้น</div>
                                        <b>
                                            <div class="total-price " id="total-price" style="color: red;">0</div>
                                        </b>
                                        <div class="ms-2 me-2">บาท</div>
                                    </div>

                            </div>

                            <!-- <button onclick="confirm()" id="con_reserv">ยืนยันการจอง</button> -->

                        </div>

                        <div class="box-padding mt-auto d-flex align-self-end">
                            <div button type="button" class="btn btn-primary fs-5" onclick="confirm()" id="con_reserv">ยืนยันการจอง</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div class="modal fade modal-lg" id="facilitymodal" tabindex="-1" aria-labelledby="facilitymodalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="facilitymodalLabel">สิ่งอำนวยความสะดวก</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

                        </div>
                        <div class="modal-body" id="body_facility">

                        </div>
                    </div>
                </div>
            </div>


        </div>
        <!-- footer -->
        <footer-component></footer-component>
        <!-- footer -->
    </div>




</section>


<script>
    window.addEventListener('load', function() {
        dateTimepicker()
    })

    function booking_search() {
        const checkinLabel = document.getElementById('checkin-label');
        checkinLabel.textContent = document.getElementById('checkin').value;
        const checkoutLabel = document.getElementById('checkout-label');
        checkoutLabel.textContent = document.getElementById('checkout').value


        const myCards = document.getElementById('my-cards');

        myCards.innerHTML = '';
        var checkin = document.getElementById('checkin').value
        var checkout = document.getElementById('checkout').value
        var roomtype = document.getElementById('roomstype').value
        fetch("/booking_search", {
            method: "post",
            headers: {
                Accept: "application/json",
                "Content-Type": "application/json"
            },

            body: JSON.stringify({
                checkin,
                checkout,
                roomtype
            })
        }).then((response) => response.json()).then((body) => {
            var available_room = body.count_available_rooms
            var room_type = body.roomtype
            var success = body.success
            var allfacility = body.allfacility

            console.log(room_type);
            console.log(allfacility);


            if (success == true) {
                if (available_room.length > 1) {
                    for (i = 0; i < room_type.length; i++) {
                        for (j = 0; j < available_room.length; j++) {
                            if (available_room[j].count_available_rooms != 0) {
                                if (available_room[j].id_typeroom == room_type[i].id) {



                                    // console.log(room_type[i].id + " " + room_type[i].name_th + " " + room_type[i].bed);


                                    const cardDiv = document.createElement('div');
                                    cardDiv.setAttribute('class', 'card cardbookingall');
                                    const row = document.createElement('div');
                                    row.setAttribute('class', 'row g-0');
                                    const col1 = document.createElement('div');
                                    col1.setAttribute('class', 'col-md-6 ');
                                    const divimgcarousel = document.createElement('div');
                                    divimgcarousel.setAttribute('id', 'carouselIndicators' + i);
                                    divimgcarousel.setAttribute('class', 'carousel slide carousel-fade');
                                    divimgcarousel.setAttribute('data-bs-ride', 'carousel');
                                    divimgcarousel.setAttribute('data-bs-interval', '3000');

                                    const divcarouselindicator = document.createElement('div');
                                    divcarouselindicator.setAttribute('class', 'carousel-indicators');
                                    const btn_divcarouselindicator = document.createElement('button');
                                    btn_divcarouselindicator.setAttribute('type', 'button');
                                    btn_divcarouselindicator.setAttribute('data-bs-target', '#carouselIndicators' + i);
                                    btn_divcarouselindicator.setAttribute('data-bs-slide-to', '0');
                                    btn_divcarouselindicator.setAttribute('class', 'active');

                                    btn_divcarouselindicator.setAttribute('aria-current', 'true');
                                    btn_divcarouselindicator.setAttribute('aria-label', 'Slide 1');
                                    const btn_divcarouselindicator1 = document.createElement('button');
                                    btn_divcarouselindicator1.setAttribute('type', 'button');
                                    btn_divcarouselindicator1.setAttribute('data-bs-target', '#carouselIndicators' + i);
                                    btn_divcarouselindicator1.setAttribute('data-bs-slide-to', '1');
                                    btn_divcarouselindicator1.setAttribute('aria-label', 'Slide 2');
                                    const btn_divcarouselindicator2 = document.createElement('button');
                                    btn_divcarouselindicator2.setAttribute('type', 'button');
                                    btn_divcarouselindicator2.setAttribute('data-bs-target', '#carouselIndicators' + i);
                                    btn_divcarouselindicator2.setAttribute('data-bs-slide-to', '2');
                                    btn_divcarouselindicator2.setAttribute('aria-label', 'Slide 3');
                                    divcarouselindicator.appendChild(btn_divcarouselindicator);
                                    divcarouselindicator.appendChild(btn_divcarouselindicator1);
                                    divcarouselindicator.appendChild(btn_divcarouselindicator2);
                                    const divcarouselinner = document.createElement('div');
                                    divcarouselinner.setAttribute('class', 'carousel-inner');
                                    const divcarousel_item = document.createElement('div');
                                    divcarousel_item.setAttribute('class', 'carousel-item active');
                                    divcarousel_item.setAttribute('data-bs-interval', '3000');
                                    const divcarousel_item1 = document.createElement('div');
                                    divcarousel_item1.setAttribute('class', 'carousel-item');
                                    divcarousel_item1.setAttribute('data-bs-interval', '3000');
                                    const divcarousel_item2 = document.createElement('div');
                                    divcarousel_item2.setAttribute('class', 'carousel-item');
                                    divcarousel_item2.setAttribute('data-bs-interval', '3000');
                                    const img = document.createElement('img');
                                    img.setAttribute('src', room_type[i].img1);
                                    img.setAttribute('class', 'img-fluid w-100 h-100 d-block');
                                    const img1 = document.createElement('img');
                                    img1.setAttribute('src', room_type[i].img2);
                                    img1.setAttribute('class', 'img-fluid w-100 h-100 d-block');
                                    const img2 = document.createElement('img');
                                    img2.setAttribute('src', room_type[i].img3);
                                    img2.setAttribute('class', 'img-fluid w-100 h-100 d-block');
                                    divcarousel_item.appendChild(img);
                                    divcarousel_item1.appendChild(img1);
                                    divcarousel_item2.appendChild(img2);;

                                    divcarouselinner.appendChild(divcarousel_item);
                                    divcarouselinner.appendChild(divcarousel_item1);
                                    divcarouselinner.appendChild(divcarousel_item2);

                                    const btncarousel_l = document.createElement('button');
                                    btncarousel_l.setAttribute('class', 'carousel-control-prev');
                                    btncarousel_l.setAttribute('type', 'button');
                                    btncarousel_l.setAttribute('data-bs-target', '#carouselIndicators' + i);
                                    btncarousel_l.setAttribute('data-bs-slide', 'prev');

                                    const span_l1 = document.createElement('span');
                                    span_l1.setAttribute('class', 'carousel-control-prev-icon');
                                    span_l1.setAttribute('aria-hidden', 'true');

                                    const span_l2 = document.createElement('span');
                                    span_l2.setAttribute('class', 'visually-hidden');
                                    span_l2.textContent = 'Previous'

                                    btncarousel_l.appendChild(span_l1);
                                    btncarousel_l.appendChild(span_l2);

                                    const btncarousel_r = document.createElement('button');
                                    btncarousel_r.setAttribute('class', 'carousel-control-next');
                                    btncarousel_r.setAttribute('type', 'button');
                                    btncarousel_r.setAttribute('data-bs-target', '#carouselIndicators' + i);
                                    btncarousel_r.setAttribute('data-bs-slide', 'next');

                                    const span1 = document.createElement('span');
                                    span1.setAttribute('class', 'carousel-control-next-icon');
                                    span1.setAttribute('aria-hidden', 'true');

                                    const span2 = document.createElement('span');
                                    span2.setAttribute('class', 'visually-hidden');
                                    span2.textContent = 'Next'

                                    btncarousel_r.appendChild(span1);
                                    btncarousel_r.appendChild(span2);

                                    divimgcarousel.appendChild(divcarouselindicator);
                                    divimgcarousel.appendChild(divcarouselinner);
                                    divimgcarousel.appendChild(btncarousel_l);
                                    divimgcarousel.appendChild(btncarousel_r);


                                    col1.appendChild(divimgcarousel);

                                    const col2 = document.createElement('div');
                                    col2.setAttribute('class', 'col-md-6 ');

                                    const cardBody = document.createElement('div');
                                    cardBody.setAttribute('class', 'card-body h-100 d-flex flex-column');

                                    const h5 = document.createElement('div');
                                    h5.setAttribute('class', 'card-title fw-semibold fs-2');
                                    h5.textContent = room_type[i].name_th + ' ' + room_type[i].bed;

                                    const t_details = document.createElement('div');
                                    t_details.setAttribute('class', 'fs-5');
                                    t_details.textContent = "รายละเอียดห้อง";

                                    var row_details = document.createElement('div');
                                    row_details.setAttribute('class', 'row mb-1 container');





                                    const col_details1 = document.createElement('div');
                                    col_details1.setAttribute('class', 'col-6 col-sm-6 col-md-6 col-lg-6 d-flex');
                                    const col_details2 = document.createElement('div');
                                    col_details2.setAttribute('class', 'col-6 col-sm-6 col-md-6 col-lg-6 d-flex');
                                    const col_details3 = document.createElement('div');
                                    col_details3.setAttribute('class', 'col-6 col-sm-6 col-md-6 col-lg-6 d-flex');
                                    const col_details4 = document.createElement('div');
                                    col_details4.setAttribute('class', 'col-6 col-sm-6 col-md-6 col-lg-6 d-flex');

                                    const detail1 = document.createElement('div');
                                    detail1.setAttribute('class', 'mb-1');
                                    detail1.textContent = 'ขนาดห้อง: ' + room_type[i].size + ' ตรม.';

                                    const detail2 = document.createElement('div');
                                    detail2.setAttribute('class', 'mb-1');
                                    detail2.textContent = 'เข้าพักได้: ' + room_type[i].count_humen + ' คน';

                                    const detail3 = document.createElement('div');
                                    detail3.setAttribute('class', 'mb-1');
                                    detail3.textContent = 'ขนาดเตียง: ' + room_type[i].type_bed;

                                    const detail4 = document.createElement('div');
                                    detail4.setAttribute('class', 'mb-1');
                                    detail4.textContent = 'ส่วนเสริม: ' + room_type[i].extional;

                                    col_details1.appendChild(detail1);
                                    col_details2.appendChild(detail2);
                                    col_details3.appendChild(detail3);
                                    col_details4.appendChild(detail4);
                                    row_details.appendChild(col_details1);
                                    row_details.appendChild(col_details2);
                                    row_details.appendChild(col_details3);
                                    row_details.appendChild(col_details4);

                                    var row_facilities = document.createElement('div');
                                    row_facilities.setAttribute('class', 'row mb-1');

                                    const t_facilities = document.createElement('div');
                                    t_facilities.setAttribute('class', 'fs-5');
                                    t_facilities.textContent = "สิ่งอำนวยความสะดวก";

                                    var mainfacility = [0, 1, 2, 3, 4, 5, 6];

                                    for (var c = 0; c < 6; c++) {
                                        // if (allfacility[c].room_type_id == room_type[i].id) {
                                        // console.log("roomtype[" + c + "].id: " + allfacility[c].room_type_id);
                                        // console.log("roomtype[" + c + "].name: " + allfacility[c].name);
                                        const col_facilities = document.createElement('div');
                                        col_facilities.setAttribute('class', 'col-6 col-sm-6 col-md-6 col-lg-4 d-flex');
                                        const i_classicon = document.createElement('i');
                                        i_classicon.setAttribute('class', allfacility[mainfacility[c]].class + ' text-center');
                                        i_classicon.setAttribute('style', 'width: 2.5rem;color: rgb(20, 163, 60)');
                                        i_classicon.textContent = allfacility[mainfacility[c]].class_nameicon;
                                        const icon = document.createElement('label');
                                        icon.appendChild(i_classicon);
                                        const text = document.createElement('label');
                                        text.textContent = allfacility[mainfacility[c]].name;
                                        col_facilities.appendChild(icon);
                                        col_facilities.appendChild(text);
                                        row_facilities.appendChild(col_facilities);
                                        // }
                                    }


                                    var fprices = document.createElement('div');
                                    fprices.setAttribute('class', 'fs-4 col-6 col-sm-6 col-md-4 col-lg-4 d-flex  align-items-center');
                                    fprices.textContent = 'ราคา ';

                                    var lprices = document.createElement('div');
                                    lprices.setAttribute('class', 'fs-4 ms-1');
                                    lprices.textContent = ' ฿/คืน';

                                    const prices = document.createElement('div');
                                    prices.setAttribute('class', 'fs-4 ms-1');
                                    prices.setAttribute('style', 'color: rgb(213, 34, 34)');
                                    prices.textContent = room_type[i].price;
                                    fprices.appendChild(prices);
                                    fprices.appendChild(lprices);

                                    const div_col_price = document.createElement('div');
                                    div_col_price.setAttribute('class', '');

                                    const bt_col_price = document.createElement('div');
                                    bt_col_price.setAttribute('class', 'row mt-auto');

                                    const usable_room = document.createElement('div');
                                    usable_room.setAttribute('class', ' card-text fs-4 col-6 col-sm-6 col-md-4 col-lg-4 d-flex  align-items-center');
                                    usable_room.textContent = 'ห้องว่าง ' + available_room[j].count_available_rooms + ' ห้อง';

                                    const btn_confirm = document.createElement('div');
                                    btn_confirm.setAttribute('class', 'col-12 col-sm-12 col-md-4 col-lg-4 d-flex justify-content-end');

                                    var more_facility = document.createElement('a')
                                    more_facility.setAttribute('class', '');
                                    more_facility.setAttribute('href', '');
                                    more_facility.value = room_type[i].id
                                        // more_facility.setAttribute('data-bs-toggle', 'modal');
                                        // more_facility.setAttribute('data-bs-target', '#morefacility' + room_type[i].id);
                                    more_facility.textContent = 'รายละเอียดเพิ่มเติม';




                                    more_facility.onclick = function(event) {
                                        event.preventDefault();
                                        console.log(this.value);
                                        var modal = document.getElementById('facilitymodal');
                                        const modalInstance = new bootstrap.Modal(modal);
                                        modalInstance.show();

                                        var row_modalfacility = document.createElement('div');
                                        row_modalfacility.setAttribute('class', 'row mb-1');

                                        var body_m = document.getElementById('body_facility')
                                        body_m.innerHTML = '';


                                        for (var c = 0; c < allfacility.length; c++) {
                                            console.log(allfacility[c].room_type_id);
                                            if (allfacility[c].room_type_id == this.value) {
                                                // console.log("roomtype[" + c + "].name: " + allfacility[c].room_type_id);
                                                // console.log("roomtype[" + c + "].name: " + allfacility[c].name);
                                                const col_modalfacility = document.createElement('div');
                                                col_modalfacility.setAttribute('class', 'col-6 col-sm-6 col-md-6 col-lg-4 d-flex');
                                                const i_classicon = document.createElement('i');
                                                i_classicon.setAttribute('class', allfacility[c].class + ' text-center');
                                                i_classicon.setAttribute('style', 'width: 2.5rem;color: rgb(20, 163, 60);');
                                                i_classicon.textContent = allfacility[c].class_nameicon;
                                                const icon = document.createElement('label');
                                                icon.appendChild(i_classicon);
                                                const text = document.createElement('label');
                                                text.textContent = allfacility[c].name;
                                                col_modalfacility.appendChild(icon);
                                                col_modalfacility.appendChild(text);
                                                row_modalfacility.appendChild(col_modalfacility);
                                            }
                                        }
                                        body_m.appendChild(row_modalfacility)
                                    }


                                    const button = document.createElement('button');
                                    button.setAttribute('class', 'btn btn-primary fs-3 ');
                                    button.setAttribute('id', 'clickviewinfo');
                                    button.textContent = 'จองห้องนี้';
                                    button.value = room_type[i].id
                                    button.onclick = function(i, j, event) {
                                        const roomtypeLabel = document.getElementById('roomtype-label');
                                        roomtypeLabel.textContent = room_type[i].name_th + ' ' + room_type[i].bed;
                                        reserv_modal(available_room[j], room_type[i]);
                                    }.bind(this, i, j, event);

                                    btn_confirm.appendChild(button);
                                    bt_col_price.appendChild(fprices);
                                    bt_col_price.appendChild(usable_room);
                                    bt_col_price.appendChild(btn_confirm);

                                    div_col_price.appendChild(bt_col_price);

                                    cardBody.appendChild(h5);
                                    cardBody.appendChild(t_details);
                                    cardBody.appendChild(row_details);
                                    cardBody.appendChild(t_facilities);
                                    cardBody.appendChild(row_facilities);
                                    cardBody.appendChild(more_facility);

                                    cardBody.appendChild(bt_col_price);
                                    col2.appendChild(cardBody);
                                    row.appendChild(col1);
                                    row.appendChild(col2);
                                    cardDiv.appendChild(row);
                                    myCards.appendChild(cardDiv);
                                }
                            }
                        }
                    }
                } else {
                    // console.log(room_type[0].id + " " + room_type[0].name_th + " " + room_type[0].bed);

                    const cardDiv = document.createElement('div');
                    cardDiv.setAttribute('class', 'card cardbooking');

                    const row = document.createElement('div');
                    row.setAttribute('class', 'row g-0');

                    const col1 = document.createElement('div');
                    col1.setAttribute('class', 'col-md-6 ');
                    const divimgcarousel = document.createElement('div');
                    divimgcarousel.setAttribute('id', 'carouselIndicators' + 0);
                    divimgcarousel.setAttribute('class', 'carousel slide carousel-fade');
                    divimgcarousel.setAttribute('data-bs-ride', 'carousel');
                    divimgcarousel.setAttribute('data-bs-interval', '3000');

                    const divcarouselindicator = document.createElement('div');
                    divcarouselindicator.setAttribute('class', 'carousel-indicators');
                    const btn_divcarouselindicator = document.createElement('button');
                    btn_divcarouselindicator.setAttribute('type', 'button');
                    btn_divcarouselindicator.setAttribute('data-bs-target', '#carouselIndicators' + 0);
                    btn_divcarouselindicator.setAttribute('data-bs-slide-to', '0');
                    btn_divcarouselindicator.setAttribute('class', 'active');

                    btn_divcarouselindicator.setAttribute('aria-current', 'true');
                    btn_divcarouselindicator.setAttribute('aria-label', 'Slide 1');
                    const btn_divcarouselindicator1 = document.createElement('button');
                    btn_divcarouselindicator1.setAttribute('type', 'button');
                    btn_divcarouselindicator1.setAttribute('data-bs-target', '#carouselIndicators' + 0);
                    btn_divcarouselindicator1.setAttribute('data-bs-slide-to', '1');
                    btn_divcarouselindicator1.setAttribute('aria-label', 'Slide 2');
                    const btn_divcarouselindicator2 = document.createElement('button');
                    btn_divcarouselindicator2.setAttribute('type', 'button');
                    btn_divcarouselindicator2.setAttribute('data-bs-target', '#carouselIndicators' + 0);
                    btn_divcarouselindicator2.setAttribute('data-bs-slide-to', '2');
                    btn_divcarouselindicator2.setAttribute('aria-label', 'Slide 3');
                    divcarouselindicator.appendChild(btn_divcarouselindicator);
                    divcarouselindicator.appendChild(btn_divcarouselindicator1);
                    divcarouselindicator.appendChild(btn_divcarouselindicator2);
                    const divcarouselinner = document.createElement('div');
                    divcarouselinner.setAttribute('class', 'carousel-inner');
                    const divcarousel_item = document.createElement('div');
                    divcarousel_item.setAttribute('class', 'carousel-item active');
                    divcarousel_item.setAttribute('data-bs-interval', '3000');
                    const divcarousel_item1 = document.createElement('div');
                    divcarousel_item1.setAttribute('class', 'carousel-item');
                    divcarousel_item1.setAttribute('data-bs-interval', '3000');
                    const divcarousel_item2 = document.createElement('div');
                    divcarousel_item2.setAttribute('class', 'carousel-item');
                    divcarousel_item2.setAttribute('data-bs-interval', '3000');
                    const img = document.createElement('img');
                    img.setAttribute('src', room_type[0].img1);
                    img.setAttribute('class', 'img-fluid w-100 h-100 d-block');
                    const img1 = document.createElement('img');
                    img1.setAttribute('src', room_type[0].img2);
                    img1.setAttribute('class', 'img-fluid w-100 h-100 d-block');
                    const img2 = document.createElement('img');
                    img2.setAttribute('src', room_type[0].img3);
                    img2.setAttribute('class', 'img-fluid w-100 h-100 d-block');
                    divcarousel_item.appendChild(img);
                    divcarousel_item1.appendChild(img1);
                    divcarousel_item2.appendChild(img2);;

                    divcarouselinner.appendChild(divcarousel_item);
                    divcarouselinner.appendChild(divcarousel_item1);
                    divcarouselinner.appendChild(divcarousel_item2);

                    const btncarousel_l = document.createElement('button');
                    btncarousel_l.setAttribute('class', 'carousel-control-prev');
                    btncarousel_l.setAttribute('type', 'button');
                    btncarousel_l.setAttribute('data-bs-target', '#carouselIndicators' + 0);
                    btncarousel_l.setAttribute('data-bs-slide', 'prev');

                    const span_l1 = document.createElement('span');
                    span_l1.setAttribute('class', 'carousel-control-prev-icon');
                    span_l1.setAttribute('aria-hidden', 'true');

                    const span_l2 = document.createElement('span');
                    span_l2.setAttribute('class', 'visually-hidden');
                    span_l2.textContent = 'Previous'

                    btncarousel_l.appendChild(span_l1);
                    btncarousel_l.appendChild(span_l2);

                    const btncarousel_r = document.createElement('button');
                    btncarousel_r.setAttribute('class', 'carousel-control-next');
                    btncarousel_r.setAttribute('type', 'button');
                    btncarousel_r.setAttribute('data-bs-target', '#carouselIndicators' + 0);
                    btncarousel_r.setAttribute('data-bs-slide', 'next');

                    const span1 = document.createElement('span');
                    span1.setAttribute('class', 'carousel-control-next-icon');
                    span1.setAttribute('aria-hidden', 'true');

                    const span2 = document.createElement('span');
                    span2.setAttribute('class', 'visually-hidden');
                    span2.textContent = 'Next'

                    btncarousel_r.appendChild(span1);
                    btncarousel_r.appendChild(span2);

                    divimgcarousel.appendChild(divcarouselindicator);
                    divimgcarousel.appendChild(divcarouselinner);
                    divimgcarousel.appendChild(btncarousel_l);
                    divimgcarousel.appendChild(btncarousel_r);


                    col1.appendChild(divimgcarousel);

                    const col2 = document.createElement('div');
                    col2.setAttribute('class', 'col-md-6');

                    const cardBody = document.createElement('div');
                    cardBody.setAttribute('class', 'card-body h-100 d-flex flex-column');

                    const h5 = document.createElement('h5');
                    h5.setAttribute('class', 'card-title fw-semibold fs-2');
                    h5.textContent = room_type[0].name_th + ' ' + room_type[0].bed;

                    const br1 = document.createElement('br');

                    const t_details = document.createElement('div');
                    t_details.setAttribute('class', 'fs-5');
                    t_details.textContent = "รายละเอียดห้อง";

                    var row_details = document.createElement('div');
                    row_details.setAttribute('class', 'row mb-1 container');

                    const col_details1 = document.createElement('div');
                    col_details1.setAttribute('class', 'col-6 col-sm-6 col-md-6 col-lg-6 d-flex');
                    const col_details2 = document.createElement('div');
                    col_details2.setAttribute('class', 'col-6 col-sm-6 col-md-6 col-lg-6 d-flex');
                    const col_details3 = document.createElement('div');
                    col_details3.setAttribute('class', 'col-6 col-sm-6 col-md-6 col-lg-6 d-flex');
                    const col_details4 = document.createElement('div');
                    col_details4.setAttribute('class', 'col-6 col-sm-6 col-md-6 col-lg-6 d-flex');

                    const detail1 = document.createElement('div');
                    detail1.setAttribute('class', 'mb-1');
                    detail1.textContent = 'ขนาดห้อง: ' + room_type[0].size + ' ตรม.';

                    const detail2 = document.createElement('div');
                    detail2.setAttribute('class', 'mb-1');
                    detail2.textContent = 'เข้าพักได้: ' + room_type[0].count_humen + ' คน';

                    const detail3 = document.createElement('div');
                    detail3.setAttribute('class', 'mb-1');
                    detail3.textContent = 'ขนาดเตียง: ' + room_type[0].type_bed;

                    const detail4 = document.createElement('div');
                    detail4.setAttribute('class', 'mb-1');
                    detail4.textContent = 'ส่วนเสริม: ' + room_type[0].extional;

                    col_details1.appendChild(detail1);
                    col_details2.appendChild(detail2);
                    col_details3.appendChild(detail3);
                    col_details4.appendChild(detail4);
                    row_details.appendChild(col_details1);
                    row_details.appendChild(col_details2);
                    row_details.appendChild(col_details3);
                    row_details.appendChild(col_details4);

                    const t_facilities = document.createElement('div');
                    t_facilities.setAttribute('class', 'fs-5');
                    t_facilities.textContent = "สิ่งอำนวยความสะดวก";



                    const row_facilities = document.createElement('div');
                    row_facilities.setAttribute('class', 'row');

                    var mainfacility = [0, 1, 2, 3, 4, 5, 6];


                    for (var c = 0; c < 6; c++) {
                        // if (allfacility[c].room_type_id == room_type[i].id) {
                        // console.log("roomtype[" + c + "].id: " + allfacility[c].room_type_id);
                        // console.log("roomtype[" + c + "].name: " + allfacility[c].name);
                        const col_facilities = document.createElement('div');
                        col_facilities.setAttribute('class', 'col-6 col-sm-6 col-md-6 col-lg-4 d-flex');
                        const i_classicon = document.createElement('i');
                        i_classicon.setAttribute('class', allfacility[mainfacility[c]].class + ' text-center');
                        i_classicon.setAttribute('style', 'width: 2.5rem;color: rgb(20, 163, 60)');
                        i_classicon.textContent = allfacility[mainfacility[c]].class_nameicon;
                        const icon = document.createElement('label');
                        icon.appendChild(i_classicon);
                        const text = document.createElement('label');
                        text.textContent = allfacility[mainfacility[c]].name;
                        col_facilities.appendChild(icon);
                        col_facilities.appendChild(text);
                        row_facilities.appendChild(col_facilities);
                        // }
                    }

                    var more_facility = document.createElement('a')
                    more_facility.setAttribute('class', '');
                    more_facility.setAttribute('href', '');
                    more_facility.value = room_type[0].id
                        // more_facility.setAttribute('data-bs-toggle', 'modal');
                        // more_facility.setAttribute('data-bs-target', '#morefacility' + room_type[i].id);
                    more_facility.textContent = 'รายละเอียดเพิ่มเติม';




                    more_facility.onclick = function(event) {
                        event.preventDefault();
                        // console.log(this.value);
                        // console.log(room_type[0].id);
                        var modal = document.getElementById('facilitymodal');
                        const modalInstance = new bootstrap.Modal(modal);
                        modalInstance.show();

                        var row_modalfacility = document.createElement('div');
                        row_modalfacility.setAttribute('class', 'row mb-1');

                        var body_m = document.getElementById('body_facility')
                        body_m.innerHTML = '';
                        for (var c = 0; c < allfacility.length; c++) {
                            if (allfacility[c].room_type_id == this.value) {
                                // console.log("roomtype[" + c + "].name: " + allfacility[c].room_type_id);
                                // console.log("roomtype[" + c + "].name: " + allfacility[c].name);
                                const col_modalfacility = document.createElement('div');
                                col_modalfacility.setAttribute('class', 'col-6 col-sm-6 col-md-6 col-lg-4 d-flex');
                                const i_classicon = document.createElement('i');
                                i_classicon.setAttribute('class', allfacility[c].class + ' text-center');
                                i_classicon.setAttribute('style', 'width: 2.5rem;color: rgb(20, 163, 60)');
                                i_classicon.textContent = allfacility[c].class_nameicon;
                                const icon = document.createElement('label');
                                icon.appendChild(i_classicon);
                                const text = document.createElement('label');
                                text.textContent = allfacility[c].name;
                                col_modalfacility.appendChild(icon);
                                col_modalfacility.appendChild(text);
                                row_modalfacility.appendChild(col_modalfacility);
                            }
                        }
                        body_m.appendChild(row_modalfacility)
                    }

                    const div_col_price = document.createElement('div');
                    div_col_price.setAttribute('class', '');

                    const bt_col_price = document.createElement('div');
                    bt_col_price.setAttribute('class', 'row mt-auto');

                    const usable_room = document.createElement('div');
                    usable_room.setAttribute('class', ' card-text fs-4 col-6 col-sm-6 col-md-4 col-lg-4 d-flex  align-items-center');
                    usable_room.textContent = 'ห้องว่าง ' + available_room + ' ห้อง';

                    const btn_confirm = document.createElement('div');
                    btn_confirm.setAttribute('class', 'col-12 col-sm-12 col-md-4 col-lg-4 d-flex justify-content-end');



                    var fprices = document.createElement('div');
                    fprices.setAttribute('class', 'fs-4 col-6 col-sm-6 col-md-4 col-lg-4 d-flex  align-items-center');
                    fprices.textContent = 'ราคา ';

                    var lprices = document.createElement('div');
                    lprices.setAttribute('class', 'fs-4 ms-1');
                    lprices.textContent = ' ฿/คืน';

                    const prices = document.createElement('div');
                    prices.setAttribute('class', 'fs-4 ms-1');
                    prices.setAttribute('style', 'color: rgb(213, 34, 34)');
                    prices.textContent = room_type[0].price;
                    fprices.appendChild(prices);
                    fprices.appendChild(lprices);


                    const button = document.createElement('button');
                    button.setAttribute('class', 'btn btn-primary fs-3 ');
                    button.setAttribute('id', 'clickviewinfo');
                    button.textContent = 'จองห้องนี้';
                    button.value = room_type[0].id
                    button.onclick = function(event) {
                        // const roomtypeLabel = document.getElementById('roomtype-label');
                        // roomtypeLabel.textContent = room_type[0].name_th + ' ' + room_type[0].bed;
                        reserv_modal(available_room[0], room_type[0]);
                    }


                    btn_confirm.appendChild(button);
                    bt_col_price.appendChild(fprices);
                    bt_col_price.appendChild(usable_room);
                    bt_col_price.appendChild(btn_confirm);


                    cardBody.appendChild(h5);
                    cardBody.appendChild(t_details);
                    cardBody.appendChild(row_details);

                    cardBody.appendChild(t_facilities);
                    cardBody.appendChild(row_facilities);
                    cardBody.appendChild(more_facility);

                    cardBody.appendChild(bt_col_price);
                    col2.appendChild(cardBody);
                    row.appendChild(col1);
                    row.appendChild(col2);
                    cardDiv.appendChild(row);
                    myCards.appendChild(cardDiv);

                }
            } else {
                const cardContainer = document.createElement('div');
                cardContainer.setAttribute('class', 'd-flex justify-content-center align-items-center vh-100');

                const cardDiv = document.createElement('div');
                cardDiv.setAttribute('class', 'card p-3');

                // ... add elements to cardDiv

                cardContainer.appendChild(cardDiv);
                myCards.appendChild(cardContainer);

            }
        });
    }


    function reserv_modal(available_rooms, roomtype) {
        const modal = document.getElementById('exampleModal');

        const modalInstance = new bootstrap.Modal(modal);
        modalInstance.show();


        // Parse check-in and check-out dates using moment.js
        var checkin = moment(document.getElementById('checkin').value, 'DD/MM/YYYY');
        var checkout = moment(document.getElementById('checkout').value, 'DD/MM/YYYY');

        // Format check-in and check-out dates as "DD/MM/YYYY" strings
        var checkinFormatted = checkin.format('DD/MM/YYYY');
        var checkoutFormatted = checkout.format('DD/MM/YYYY');

        // Calculate the number of days between check-in and check-out
        var diffDays = checkout.diff(checkin, 'days') + 1; // Add 1 day to include both check-in and check-out dates

        // console.log('Check-in date: ' + checkinFormatted);
        // console.log('Check-out date: ' + checkoutFormatted);
        // console.log('Number of days: ' + diffDays);





        document.getElementById('total-price').innerHTML = " " + (roomtype.price * (diffDays - 1))
            // document.getElementById('exampleModalLabel').innerHTML = 'ยืนยันการจองห้อง ' + roomtype.name_th + ' ' + roomtype.bed

        document.getElementById('con_reserv').value = roomtype.id
    }

    function confirm() {
        var firstName = document.getElementById('firstName').value
        var p_number = document.getElementById('p_number').value
        var email = document.getElementById('email').value
        var lastName = document.getElementById('lastName').value
        var more_info = document.getElementById('more_info').value
        var checkin = document.getElementById('checkin').value
        var checkout = document.getElementById('checkout').value
        var room_type = document.getElementById('con_reserv').value


        const radioButtons = document.getElementsByName('myGroup');
        if (!firstName || !p_number || !email || !lastName || !checkin || !checkout || !room_type) {
            Swal.fire({
                title: 'กรุณากรอกข้อมูลให้ครบถ้วน',
                backdrop: true,
                customClass: {
                    backdrop: 'swal-backdrop-blur',

                },
            });

        } else {
            Swal.fire({
                title: 'ต้องการจองห้องนี้หรือไม่',
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                cancelButtonText: 'ไม่',
                confirmButtonText: 'ใช่'
            }).then((result) => {
                if (result.isConfirmed) {
                    let payment;

                    for (let i = 0; i < radioButtons.length; i++) {
                        if (radioButtons[i].checked) {
                            payment = radioButtons[i].value;
                            break;
                        }
                    }

                    fetch("/confirm_booking_room", {
                        method: "post",
                        headers: {
                            Accept: "application/json",
                            "Content-Type": "application/json"
                        },

                        body: JSON.stringify({
                            firstName,
                            p_number,
                            email,
                            lastName,
                            more_info,
                            payment,
                            checkin,
                            checkout,
                            room_type
                        })
                    }).then((response) => response.json()).then((body) => {
                        Swal.fire({
                            title: 'รบกวนรอการยืนยันห้องทางอีเมลล์',
                            text: 'รหัสการจองห้องคือ ' + body.reserved_custom_id + ' สามารถใช้ค้นหาในเมนูเช็คห้องพักได้',
                            icon: 'success',
                            showConfirmButton: true,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                            allowEnterKey: false,
                            // preConfirm: () => {
                            //     return new Promise((resolve) => {
                            //         setTimeout(() => {
                            //             showConfirmButton: true,
                            //             resolve();
                            //         }, 3000);
                            //     });
                            // }
                        }).then(() => {

                            const modal = document.getElementById('exampleModal');
                            const modalInstance = new bootstrap.Modal(modal);

                            // To hide the modal
                            modalInstance.hide();

                            window.location.hash = 'home';
                            location.reload();
                        });
                    })

                }
            })
        }
    }

    function dateTimepicker() { // date time picker
        const checkin = document.querySelector("#checkin");
        const checkout = document.querySelector("#checkout");

        flatpickr(checkin, {
            defaultDate: new Date(),
            locale: "th",
            dateFormat: "d-m-Y",
            minDate: new Date(),
            onChange: function(selectedDates, dateStr, instance) {

                if (checkout.value) {
                    if (checkout.value < dateStr) {
                        checkout.value = dateStr;
                    }
                }
                checkout.flatpickr({
                    locale: "th",
                    dateFormat: "d-m-Y",
                    minDate: selectedDates[0].fp_incr(1),
                    defaultDate: selectedDates[0].fp_incr(1)
                });

            }
        });
        flatpickr(checkout, {
            locale: "th",
            dateFormat: "d-m-Y",
            defaultDate: new Date(Date.now() + 86400000),
            minDate: new Date(Date.now() + 86400000)
        });
    }


    const emailInput = document.getElementById('email');
    emailInput.addEventListener('onkeyup', function(event) {
        if (!isValidEmail(event.target.value)) {
            event.target.setCustomValidity('Please enter a valid email address');
        } else {
            event.target.setCustomValidity('');
        }
    });

    function isValidEmail(email) {
        // Use regular expression to check if the email is valid
        const emailRegex = /^[^\s@]+@[^\s@]+.[^\s@]+$/;
        return emailRegex.test(email);
    }


    const numericInput = document.getElementById('p_number');
    numericInput.addEventListener('input', function(event) {
        const newValue = event.target.value.replace(/[^\d]/g, '');
        event.target.value = newValue;
        if (newValue.length > 10) {
            event.target.value = newValue.slice(0, 10);
        } else {
            event.target.value = newValue;
        }
    });
</script>